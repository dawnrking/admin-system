import{j as pe,k as ve,m as fe,n as ge,o as ye}from"./index-BJc8UowC.js";import{d as z,r as J,c as C,u as Q,_ as W,y as _e,a as L,f as l,w as a,g as v,M as b,h as d,o as P,b as j,j as h,A as Z,F as I,m as N,k as f,B as be,p as T,C as Ce,t as $,n as he,E as A}from"./index-B4wjXhve.js";import{r as ke}from"./refresh-BMsJwR8x.js";import{e as we}from"./edit-BzhVpeKC.js";function R(u,n){var i=Object.keys(u);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(u);n&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(u,c).enumerable})),i.push.apply(i,r)}return i}function q(u){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?R(Object(i),!0).forEach(function(r){W(u,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(i)):R(Object(i)).forEach(function(r){Object.defineProperty(u,r,Object.getOwnPropertyDescriptor(i,r))})}return u}var xe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM23 12C23 18.0751 18.0751 23 12 23C5.92487 23 0.999999 18.0751 1 12C1 5.92487 5.92487 0.999999 12 1C18.0751 1 23 5.92487 23 12ZM10.5 16.4142L6.08578 12L7.5 10.5858L10.5 13.5858L16.5 7.58579L17.9142 9L10.5 16.4142Z"}}]},Oe=z({name:"CheckCircleIcon",props:{size:{type:String},onClick:{type:Function}},setup(u,n){var{attrs:i}=n,r=C(()=>u.size),{className:c,style:g}=Q(r),y=C(()=>["t-icon","t-icon-check-circle",c.value]),k=C(()=>q(q({},g.value),i.style)),s=C(()=>({class:y.value,style:k.value,onClick:w=>{var m;return(m=u.onClick)===null||m===void 0?void 0:m.call(u,{e:w})}}));return()=>J(xe,s.value)}});function G(u,n){var i=Object.keys(u);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(u);n&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(u,c).enumerable})),i.push.apply(i,r)}return i}function H(u){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?G(Object(i),!0).forEach(function(r){W(u,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(i)):G(Object(i)).forEach(function(r){Object.defineProperty(u,r,Object.getOwnPropertyDescriptor(i,r))})}return u}var Ve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM23 12C23 18.0751 18.0751 23 12 23C5.92487 23 0.999999 18.0751 1 12C1 5.92487 5.92487 0.999999 12 1C18.0751 1 23 5.92487 23 12ZM7.40347 15.1823L10.5858 12L7.40347 8.81768L8.81768 7.40347L12 10.5858L15.1816 7.40415L16.5959 8.81836L13.4142 12L16.5959 15.1816L15.1816 16.5959L12 13.4142L8.81768 16.5965L7.40347 15.1823Z"}}]},Pe=z({name:"CloseCircleIcon",props:{size:{type:String},onClick:{type:Function}},setup(u,n){var{attrs:i}=n,r=C(()=>u.size),{className:c,style:g}=Q(r),y=C(()=>["t-icon","t-icon-close-circle",c.value]),k=C(()=>H(H({},g.value),i.style)),s=C(()=>({class:y.value,style:k.value,onClick:w=>{var m;return(m=u.onClick)===null||m===void 0?void 0:m.call(u,{e:w})}}));return()=>J(Ve,s.value)}});const je={class:"space-y-6"},Se={class:"flex flex-wrap gap-4 items-end"},Le={class:"text-orange-500 font-semibold"},$e={class:"flex gap-2"},Ue=z({__name:"Products",setup(u){const n=v([]),i=v(!1),r=v(""),c=v(""),g=v(""),y=v(!1),k=v("新增商品"),s=v({}),w=v(!1),m=v({current:1,pageSize:10,total:0}),D=["电子产品","服饰鞋包","家居用品","电脑配件"],X=C(()=>{let o=n.value;return r.value&&(o=o.filter(e=>e.name.includes(r.value))),c.value&&(o=o.filter(e=>e.status===c.value)),g.value&&(o=o.filter(e=>e.category===g.value)),m.value.total=o.length,o}),Y=[{colKey:"id",title:"ID",width:80},{colKey:"image",title:"图片",width:100},{colKey:"name",title:"商品名称",width:200},{colKey:"category",title:"分类",width:120},{colKey:"price",title:"价格",width:120},{colKey:"stock",title:"库存",width:100},{colKey:"status",title:"状态",width:120},{colKey:"createTime",title:"创建时间",width:150},{colKey:"operation",title:"操作",width:200,fixed:"right"}],K=()=>{m.value.current=1},ee=()=>{r.value="",c.value="",g.value="",m.value.current=1},te=()=>{w.value=!1,k.value="新增商品",s.value={name:"",category:"",price:0,stock:0,status:"off_sale",image:"",description:""},y.value=!0},le=o=>{w.value=!0,k.value="编辑商品",s.value={...o},y.value=!0},ae=o=>{const e=A.confirm({header:"确认删除",body:`确定要删除商品"${o.name}"吗？`,confirmBtn:"确定",cancelBtn:"取消",onConfirm:async()=>{try{await ve(o.id),n.value=n.value.filter(p=>p.id!==o.id),b.success("删除成功")}catch{b.error("删除失败")}e.destroy()}})},B=o=>{const e=o.status==="on_sale"?"off_sale":"on_sale",p=e==="on_sale"?"上架":"下架",V=A.confirm({header:`确认${p}`,body:`确定要${p}商品"${o.name}"吗？`,confirmBtn:"确定",cancelBtn:"取消",onConfirm:async()=>{try{await fe(o.id,e);const x=n.value.findIndex(_=>_.id===o.id);x!==-1&&(n.value[x].status=e,b.success(`${p}成功`))}catch{b.error(`${p}失败`)}V.destroy()}})},ne=async()=>{if(!s.value.name||!s.value.category){b.warning("请填写完整信息");return}try{if(w.value){await ge(s.value.id,s.value);const o=n.value.findIndex(e=>e.id===s.value.id);o!==-1&&(n.value[o]={...n.value[o],...s.value},b.success("编辑成功"))}else{const o=await ye(s.value);n.value.unshift(o),b.success("添加成功")}y.value=!1}catch{b.error("操作失败")}},U=o=>o==="on_sale"?{theme:"success",text:"在售"}:{theme:"default",text:"下架"},oe=async()=>{i.value=!0;try{n.value=await pe()}catch{b.error("获取商品列表失败")}finally{i.value=!1}};return _e(()=>{oe()}),(o,e)=>{const p=d("t-input"),V=d("t-option"),x=d("t-select"),_=d("t-button"),E=d("t-card"),re=d("t-image"),se=d("t-tag"),ie=d("t-table"),O=d("t-form-item"),M=d("t-input-number"),ue=d("t-textarea"),F=d("t-radio"),de=d("t-radio-group"),ce=d("t-form"),me=d("t-dialog");return P(),L("div",je,[l(E,{bordered:!1},{default:a(()=>[j("div",Se,[l(p,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),placeholder:"搜索商品名称",clearable:"",style:{width:"200px"},onEnter:K},{"prefix-icon":a(()=>[l(h(Z))]),_:1},8,["modelValue"]),l(x,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),placeholder:"状态筛选",clearable:"",style:{width:"150px"}},{default:a(()=>[l(V,{value:"on_sale",label:"在售"}),l(V,{value:"off_sale",label:"下架"})]),_:1},8,["modelValue"]),l(x,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),placeholder:"分类筛选",clearable:"",style:{width:"150px"}},{default:a(()=>[(P(),L(I,null,N(D,t=>l(V,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(_,{theme:"primary",onClick:K},{icon:a(()=>[l(h(Z))]),default:a(()=>[e[12]||(e[12]=f(" 搜索 ",-1))]),_:1}),l(_,{theme:"default",onClick:ee},{icon:a(()=>[l(h(ke))]),default:a(()=>[e[13]||(e[13]=f(" 重置 ",-1))]),_:1}),e[15]||(e[15]=j("div",{class:"flex-1"},null,-1)),l(_,{theme:"primary",onClick:te},{icon:a(()=>[l(h(be))]),default:a(()=>[e[14]||(e[14]=f(" 新增商品 ",-1))]),_:1})])]),_:1}),l(E,{bordered:!1},{default:a(()=>[l(ie,{data:X.value,columns:Y,loading:i.value,pagination:m.value,"row-key":"id",hover:"",stripe:"",onPageChange:e[3]||(e[3]=t=>m.value.current=t.current)},{image:a(({row:t})=>[l(re,{src:t.image,style:{width:"60px",height:"60px"},fit:"cover",shape:"round"},null,8,["src"])]),price:a(({row:t})=>[j("span",Le,"¥"+$(t.price.toLocaleString()),1)]),stock:a(({row:t})=>[j("span",{class:he(t.stock===0?"text-red-500":"")},$(t.stock),3)]),status:a(({row:t})=>[l(se,{theme:U(t.status).theme,variant:"light"},{default:a(()=>[f($(U(t.status).text),1)]),_:2},1032,["theme"])]),operation:a(({row:t})=>[j("div",$e,[t.status==="off_sale"?(P(),T(_,{key:0,theme:"success",variant:"text",size:"small",onClick:S=>B(t)},{icon:a(()=>[l(h(Oe))]),default:a(()=>[e[16]||(e[16]=f(" 上架 ",-1))]),_:1},8,["onClick"])):(P(),T(_,{key:1,theme:"warning",variant:"text",size:"small",onClick:S=>B(t)},{icon:a(()=>[l(h(Pe))]),default:a(()=>[e[17]||(e[17]=f(" 下架 ",-1))]),_:1},8,["onClick"])),l(_,{theme:"primary",variant:"text",size:"small",onClick:S=>le(t)},{icon:a(()=>[l(h(we))]),default:a(()=>[e[18]||(e[18]=f(" 编辑 ",-1))]),_:1},8,["onClick"]),l(_,{theme:"danger",variant:"text",size:"small",onClick:S=>ae(t)},{icon:a(()=>[l(h(Ce))]),default:a(()=>[e[19]||(e[19]=f(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1},8,["data","loading","pagination"])]),_:1}),l(me,{visible:y.value,"onUpdate:visible":e[11]||(e[11]=t=>y.value=t),header:k.value,width:"600px","confirm-on-enter":!0,onConfirm:ne},{default:a(()=>[l(ce,{data:s.value,"label-width":"100px"},{default:a(()=>[l(O,{label:"商品名称",name:"name"},{default:a(()=>[l(p,{modelValue:s.value.name,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.name=t),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1}),l(O,{label:"分类",name:"category"},{default:a(()=>[l(x,{modelValue:s.value.category,"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.category=t),placeholder:"请选择分类"},{default:a(()=>[(P(),L(I,null,N(D,t=>l(V,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),l(O,{label:"价格",name:"price"},{default:a(()=>[l(M,{modelValue:s.value.price,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.price=t),min:0,"decimal-places":2,theme:"normal",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(O,{label:"库存",name:"stock"},{default:a(()=>[l(M,{modelValue:s.value.stock,"onUpdate:modelValue":e[7]||(e[7]=t=>s.value.stock=t),min:0,theme:"normal",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(O,{label:"图片链接",name:"image"},{default:a(()=>[l(p,{modelValue:s.value.image,"onUpdate:modelValue":e[8]||(e[8]=t=>s.value.image=t),placeholder:"请输入图片链接"},null,8,["modelValue"])]),_:1}),l(O,{label:"商品描述",name:"description"},{default:a(()=>[l(ue,{modelValue:s.value.description,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.description=t),placeholder:"请输入商品描述",maxlength:200},null,8,["modelValue"])]),_:1}),l(O,{label:"状态",name:"status"},{default:a(()=>[l(de,{modelValue:s.value.status,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.status=t)},{default:a(()=>[l(F,{value:"on_sale"},{default:a(()=>[...e[20]||(e[20]=[f("上架",-1)])]),_:1}),l(F,{value:"off_sale"},{default:a(()=>[...e[21]||(e[21]=[f("下架",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}});export{Ue as default};
