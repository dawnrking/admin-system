import{e as E,f as z,h as le,i as ae}from"./index-RM_-i1Vi.js";import{d as oe,y as ne,a as b,b as y,f as l,w as a,g as i,c as F,M as u,h as d,o as V,j as m,A as ue,F as C,m as K,k as r,D as se,C as M,B as ie,t as I}from"./index-wm2MAxWb.js";import{r as de}from"./refresh-DaLjTMOS.js";import{e as re}from"./edit-DcWb3vV2.js";const ce={class:"space-y-6"},me={class:"bg-white rounded-xl p-6 shadow-sm"},ve={class:"flex flex-wrap items-center gap-4"},pe={class:"bg-white rounded-xl shadow-sm overflow-hidden"},fe={class:"text-blue-600 font-medium"},ye={class:"flex items-center space-x-2"},Ve=oe({__name:"DataTable",setup(ge){const s=i([]),g=i(""),x=i(""),N=i(""),_=i(!1),h=i(!1),U=i(""),D=i(!1),n=i({orderNo:"",productName:"",category:"",price:0,quantity:0,status:""}),S=["电子产品","服饰鞋包","家居用品","电脑配件"],q=["已完成","进行中","待处理","已取消"],B=F(()=>s.value.filter(o=>{const t=!g.value||o.orderNo.includes(g.value)||o.productName.includes(g.value),w=!x.value||o.category===x.value,v=!N.value||o.status===N.value;return t&&w&&v})),R=[{colKey:"row-select",type:"multiple",width:50},{colKey:"id",title:"ID",width:60},{colKey:"orderNo",title:"订单号",width:140},{colKey:"productName",title:"商品名称",width:160},{colKey:"category",title:"分类",width:100},{colKey:"price",title:"单价",width:100},{colKey:"quantity",title:"数量",width:80},{colKey:"total",title:"总金额",width:120},{colKey:"status",title:"状态",width:100},{colKey:"createTime",title:"创建时间",width:120},{colKey:"operation",title:"操作",width:150,fixed:"right"}],c=i([]),A=()=>{U.value="添加数据",D.value=!1,n.value={orderNo:"ORD"+Date.now().toString().slice(-8),productName:"",category:"",price:0,quantity:1,status:"待处理"},h.value=!0},L=o=>{U.value="编辑数据",D.value=!0,n.value={...o},h.value=!0},O=async()=>{if(!n.value.productName||!n.value.category){u.warning("请填写必填项");return}try{if(D.value){await le(n.value.id,n.value);const o=s.value.findIndex(t=>t.id===n.value.id);o!==-1&&(s.value[o]={...s.value[o],...n.value}),u.success("更新成功")}else{const o=await ae(n.value);s.value.unshift(o),u.success("添加成功")}h.value=!1}catch{u.error("操作失败")}},P=async o=>{try{await z(o.id),s.value=s.value.filter(t=>t.id!==o.id),u.success("删除成功")}catch{u.error("删除失败")}},$=async()=>{if(c.value.length===0){u.warning("请选择要删除的数据");return}try{await Promise.all(c.value.map(o=>z(o))),s.value=s.value.filter(o=>!c.value.includes(o.id)),c.value=[],u.success("批量删除成功")}catch{u.error("批量删除失败")}},j=async()=>{_.value=!0;try{s.value=await E(),u.success("刷新成功")}catch{u.error("刷新失败")}finally{_.value=!1}},G=()=>{u.info("导出功能演示")},H=o=>({已完成:"success",进行中:"primary",待处理:"warning",已取消:"danger"})[o]||"default",J=i({current:1,pageSize:10,total:F(()=>B.value.length)}),Q=async()=>{_.value=!0;try{s.value=await E()}catch{u.error("获取数据列表失败")}finally{_.value=!1}};return ne(()=>{Q()}),(o,t)=>{const w=d("t-input"),v=d("t-option"),k=d("t-select"),p=d("t-button"),W=d("t-tag"),X=d("t-popconfirm"),Y=d("t-table"),f=d("t-form-item"),T=d("t-input-number"),Z=d("t-form"),ee=d("t-dialog");return V(),b("div",ce,[y("div",me,[y("div",ve,[l(w,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:"搜索订单号或商品名",clearable:"",style:{width:"240px"}},{"prefix-icon":a(()=>[l(m(ue))]),_:1},8,["modelValue"]),l(k,{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=e=>x.value=e),placeholder:"选择分类",clearable:"",style:{width:"140px"}},{default:a(()=>[(V(),b(C,null,K(S,e=>l(v,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(k,{modelValue:N.value,"onUpdate:modelValue":t[2]||(t[2]=e=>N.value=e),placeholder:"选择状态",clearable:"",style:{width:"120px"}},{default:a(()=>[(V(),b(C,null,K(q,e=>l(v,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),t[15]||(t[15]=y("div",{class:"flex-1"},null,-1)),l(p,{variant:"outline",onClick:j},{icon:a(()=>[l(m(de))]),default:a(()=>[t[11]||(t[11]=r(" 刷新 ",-1))]),_:1}),l(p,{variant:"outline",onClick:G},{icon:a(()=>[l(m(se))]),default:a(()=>[t[12]||(t[12]=r(" 导出 ",-1))]),_:1}),l(p,{theme:"danger",variant:"outline",disabled:c.value.length===0,onClick:$},{icon:a(()=>[l(m(M))]),default:a(()=>[t[13]||(t[13]=r(" 批量删除 ",-1))]),_:1},8,["disabled"]),l(p,{theme:"primary",onClick:A},{icon:a(()=>[l(m(ie))]),default:a(()=>[t[14]||(t[14]=r(" 添加数据 ",-1))]),_:1})])]),y("div",pe,[l(Y,{data:B.value,columns:R,pagination:J.value,loading:_.value,"selected-row-keys":c.value,"row-key":"id",hover:"",stripe:"",onSelectChange:t[3]||(t[3]=e=>c.value=e)},{price:a(({row:e})=>[r(" ¥"+I(e.price.toFixed(2)),1)]),total:a(({row:e})=>[y("span",fe," ¥"+I((e.price*e.quantity).toLocaleString()),1)]),status:a(({row:e})=>[l(W,{theme:H(e.status),variant:"light"},{default:a(()=>[r(I(e.status),1)]),_:2},1032,["theme"])]),operation:a(({row:e})=>[y("div",ye,[l(p,{theme:"primary",variant:"text",size:"small",onClick:te=>L(e)},{icon:a(()=>[l(m(re))]),default:a(()=>[t[16]||(t[16]=r(" 编辑 ",-1))]),_:1},8,["onClick"]),l(X,{content:"确定要删除该数据吗？",onConfirm:te=>P(e)},{default:a(()=>[l(p,{theme:"danger",variant:"text",size:"small"},{icon:a(()=>[l(m(M))]),default:a(()=>[t[17]||(t[17]=r(" 删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])])]),_:1},8,["data","pagination","loading","selected-row-keys"])]),l(ee,{visible:h.value,"onUpdate:visible":t[10]||(t[10]=e=>h.value=e),header:U.value,"confirm-on-enter":!0,onConfirm:O},{default:a(()=>[l(Z,{data:n.value,"label-width":"80px"},{default:a(()=>[l(f,{label:"订单号",name:"orderNo"},{default:a(()=>[l(w,{modelValue:n.value.orderNo,"onUpdate:modelValue":t[4]||(t[4]=e=>n.value.orderNo=e),placeholder:"请输入订单号",disabled:D.value},null,8,["modelValue","disabled"])]),_:1}),l(f,{label:"商品名称",name:"productName"},{default:a(()=>[l(w,{modelValue:n.value.productName,"onUpdate:modelValue":t[5]||(t[5]=e=>n.value.productName=e),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1}),l(f,{label:"分类",name:"category"},{default:a(()=>[l(k,{modelValue:n.value.category,"onUpdate:modelValue":t[6]||(t[6]=e=>n.value.category=e),placeholder:"请选择分类"},{default:a(()=>[(V(),b(C,null,K(S,e=>l(v,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"单价",name:"price"},{default:a(()=>[l(T,{modelValue:n.value.price,"onUpdate:modelValue":t[7]||(t[7]=e=>n.value.price=e),min:0,"decimal-places":2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(f,{label:"数量",name:"quantity"},{default:a(()=>[l(T,{modelValue:n.value.quantity,"onUpdate:modelValue":t[8]||(t[8]=e=>n.value.quantity=e),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(f,{label:"状态",name:"status"},{default:a(()=>[l(k,{modelValue:n.value.status,"onUpdate:modelValue":t[9]||(t[9]=e=>n.value.status=e),placeholder:"请选择状态"},{default:a(()=>[(V(),b(C,null,K(q,e=>l(v,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}});export{Ve as default};
