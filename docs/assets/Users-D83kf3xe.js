import{b as H,d as J,u as Q,c as R}from"./index-BJc8UowC.js";import{d as W,y as X,a as f,b as _,f as l,w as a,g as u,c as T,M as i,h as s,o as h,j as V,A as Y,F as w,m as x,k as U,B as Z,C as ee,t as te}from"./index-B4wjXhve.js";import{e as le}from"./edit-BzhVpeKC.js";const ae={class:"space-y-6"},ne={class:"bg-white rounded-xl p-6 shadow-sm"},oe={class:"flex flex-wrap items-center gap-4"},se={class:"bg-white rounded-xl shadow-sm overflow-hidden"},ue={class:"flex items-center space-x-2"},ce=W({__name:"Users",setup(de){const d=u([]),c=u(""),b=u(""),g=u(""),p=u(!1),k=u(""),C=u(!1),n=u({name:"",email:"",phone:"",department:"",status:""}),D=["技术部","产品部","市场部","人事部","财务部","运营部"],S=["在职","离职","休假"],B=T(()=>d.value.filter(o=>{const t=!c.value||o.name.includes(c.value)||o.email.includes(c.value),r=!b.value||o.department===b.value,m=!g.value||o.status===g.value;return t&&r&&m})),z=[{colKey:"id",title:"ID",width:80},{colKey:"name",title:"姓名",width:100},{colKey:"email",title:"邮箱",width:200},{colKey:"phone",title:"手机号",width:140},{colKey:"department",title:"部门",width:120},{colKey:"status",title:"状态",width:100},{colKey:"createTime",title:"创建时间",width:120},{colKey:"operation",title:"操作",width:150,fixed:"right"}],E=()=>{k.value="添加用户",C.value=!1,n.value={name:"",email:"",phone:"",department:"",status:"在职"},p.value=!0},M=o=>{k.value="编辑用户",C.value=!0,n.value={...o},p.value=!0},N=async()=>{if(!n.value.name||!n.value.email){i.warning("请填写必填项");return}try{if(C.value){await Q(n.value.id,n.value);const o=d.value.findIndex(t=>t.id===n.value.id);o!==-1&&(d.value[o]={...d.value[o],...n.value}),i.success("更新成功")}else{const o=await R(n.value);d.value.unshift(o),i.success("添加成功")}p.value=!1}catch{i.error("操作失败")}},A=async o=>{try{await J(o.id),d.value=d.value.filter(t=>t.id!==o.id),i.success("删除成功")}catch{i.error("删除失败")}},F=o=>({在职:"success",离职:"danger",休假:"warning"})[o]||"default",I=u({current:1,pageSize:10,total:T(()=>B.value.length)}),$=async()=>{try{d.value=await H()}catch{i.error("获取用户列表失败")}};return X(()=>{$()}),(o,t)=>{const r=s("t-input"),m=s("t-option"),y=s("t-select"),K=s("t-button"),j=s("t-tag"),L=s("t-popconfirm"),O=s("t-table"),v=s("t-form-item"),P=s("t-form"),q=s("t-dialog");return h(),f("div",ae,[_("div",ne,[_("div",oe,[l(r,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),placeholder:"搜索姓名或邮箱",clearable:"",style:{width:"240px"}},{"prefix-icon":a(()=>[l(V(Y))]),_:1},8,["modelValue"]),l(y,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),placeholder:"选择部门",clearable:"",style:{width:"160px"}},{default:a(()=>[(h(),f(w,null,x(D,e=>l(m,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(y,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=e=>g.value=e),placeholder:"选择状态",clearable:"",style:{width:"120px"}},{default:a(()=>[(h(),f(w,null,x(S,e=>l(m,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),t[10]||(t[10]=_("div",{class:"flex-1"},null,-1)),l(K,{theme:"primary",onClick:E},{icon:a(()=>[l(V(Z))]),default:a(()=>[t[9]||(t[9]=U(" 添加用户 ",-1))]),_:1})])]),_("div",se,[l(O,{data:B.value,columns:z,pagination:I.value,"row-key":"id",hover:"",stripe:""},{status:a(({row:e})=>[l(j,{theme:F(e.status),variant:"light"},{default:a(()=>[U(te(e.status),1)]),_:2},1032,["theme"])]),operation:a(({row:e})=>[_("div",ue,[l(K,{theme:"primary",variant:"text",size:"small",onClick:G=>M(e)},{icon:a(()=>[l(V(le))]),default:a(()=>[t[11]||(t[11]=U(" 编辑 ",-1))]),_:1},8,["onClick"]),l(L,{content:"确定要删除该用户吗？",onConfirm:G=>A(e)},{default:a(()=>[l(K,{theme:"danger",variant:"text",size:"small"},{icon:a(()=>[l(V(ee))]),default:a(()=>[t[12]||(t[12]=U(" 删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])])]),_:1},8,["data","pagination"])]),l(q,{visible:p.value,"onUpdate:visible":t[8]||(t[8]=e=>p.value=e),header:k.value,"confirm-on-enter":!0,onConfirm:N},{default:a(()=>[l(P,{data:n.value,"label-width":"80px"},{default:a(()=>[l(v,{label:"姓名",name:"name"},{default:a(()=>[l(r,{modelValue:n.value.name,"onUpdate:modelValue":t[3]||(t[3]=e=>n.value.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(v,{label:"邮箱",name:"email"},{default:a(()=>[l(r,{modelValue:n.value.email,"onUpdate:modelValue":t[4]||(t[4]=e=>n.value.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(v,{label:"手机号",name:"phone"},{default:a(()=>[l(r,{modelValue:n.value.phone,"onUpdate:modelValue":t[5]||(t[5]=e=>n.value.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(v,{label:"部门",name:"department"},{default:a(()=>[l(y,{modelValue:n.value.department,"onUpdate:modelValue":t[6]||(t[6]=e=>n.value.department=e),placeholder:"请选择部门"},{default:a(()=>[(h(),f(w,null,x(D,e=>l(m,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"状态",name:"status"},{default:a(()=>[l(y,{modelValue:n.value.status,"onUpdate:modelValue":t[7]||(t[7]=e=>n.value.status=e),placeholder:"请选择状态"},{default:a(()=>[(h(),f(w,null,x(S,e=>l(m,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}});export{ce as default};
